#!/usr/bin/env python3
"""
Use-After-Free attempt.

The cleanup at 0x1c86 iterates sequentially through the page array.
What if we:
1. Write zeros to page A (gets freed)
2. Allocate page B (might reuse A's memory)
3. Access page A again (page table was cleared, so re-allocated!)

Actually the cleanup calls free_pages which clears the page table entry.
So accessing page A again would just allocate a new page.

Let me think differently. The cleanup checks if page[4..0x103] is all zeros.
What if the page's 4-byte header is non-zero but data is zero?
The page would be freed, but its header is preserved...

Actually no, free() would return the whole chunk.

What about tcache poisoning during the final cleanup?
When execution ends, ALL pages are freed via free_all_pages (0x1750).
"""
from pwn import *

# Let me look for the final cleanup
